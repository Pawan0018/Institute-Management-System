@model InstitudeManagement.Models.Addmission1

@{
    ViewData["Title"] = "Create Admission";
}

<nav class="navbar navbar-light  bg-warning">
    <div class="container-fluid d-flex justify-content-between align-items-center">
        <a href="/" class="navbar-brand">
            <img src="~/Images/Picsart_24-12-07_18-34-26-772 (1).png" style="width:80px;" alt="Logo" />
        </a>
        <h1 class="mx-auto text-center text-white">Fill Student Information</h1>
    </div>
</nav>

<div class="container my-5  fw-bold">
    <hr class="mb-5" />
    <div class="row justify-content-center">
        <div class="col-lg-8 col-md-10">
            <div class="card shadow-lg">
                <div class="card-body bg-light">
                    <form class="bg-light" asp-action="Create" method="post">
                        <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>

                        <!-- Basic Information -->
                        <h5 class="text-info mb-4"><i class="bi bi-person-fill"></i> Basic Information</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="Name" class="form-label">Name</label>
                                <input asp-for="Name" class="form-control" placeholder="Enter your full name" />
                                <span asp-validation-for="Name" class="text-danger"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="Gender" class="form-label">Gender</label>
                                <div class="form-check form-check-inline">
                                    <input asp-for="Gender" type="radio" value="Male" class="form-check-input" id="Male" />
                                    <label class="form-check-label" for="Male">Male</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input asp-for="Gender" type="radio" value="Female" class="form-check-input" id="Female" />
                                    <label class="form-check-label" for="Female">Female</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input asp-for="Gender" type="radio" value="Other" class="form-check-input" id="Other" />
                                    <label class="form-check-label" for="Other">Other</label>
                                </div>
                                <span asp-validation-for="Gender" class="text-danger"></span>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label asp-for="Dob" class="form-label">Date of Birth</label>
                                <input asp-for="Dob" id="admissionDate" type="date" class="form-control" placeholder="dd/mm/yyyy" />
                                <span asp-validation-for="Dob" class="text-danger"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="AadharcardNo" class="form-label">AadharcardNo</label>
                                <input asp-for="AadharcardNo" class="form-control" placeholder="Enter AadharcardNo number" />
                                <span asp-validation-for="AadharcardNo" class="text-danger"></span>
                            </div>

                          
                            <div class="col-12 mb-3">
                                <label asp-for="Email" class="form-label">Email</label>
                                <input asp-for="Email" class="form-control" placeholder="Enter your email" />
                                <span asp-validation-for="Email" class="text-danger"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="ContactNo" class="form-label">Contact Number</label>
                                <input asp-for="ContactNo" class="form-control" placeholder="Enter your contact number" />
                                <span asp-validation-for="ContactNo" class="text-danger"></span>
                            </div>
                             
                           
                        </div>

                        <!-- Parent and Address Details -->
                        <h5 class="text-info mt-4 mb-4"><i class="bi bi-house-door-fill"></i> Parent and Address Details</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="ParentName" class="form-label">Parent Name</label>
                                <input asp-for="ParentName" class="form-control" placeholder="Enter parent name" />
                                <span asp-validation-for="ParentName" class="text-danger"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="ParentContactNo" class="form-label">Parent Contact Number</label>
                                <input asp-for="ParentContactNo" class="form-control" placeholder="Enter parent's contact number" />
                                <span asp-validation-for="ParentContactNo" class="text-danger"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="PermanentAddress" class="form-label">Permanent Address</label>
                                <input asp-for="PermanentAddress" class="form-control" placeholder="Enter permanent address" />
                                <span asp-validation-for="PermanentAddress" class="text-danger"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="CurrentAddress" class="form-label">Current Address</label>
                                <input asp-for="CurrentAddress" class="form-control" placeholder="Enter current address" />
                                <span asp-validation-for="CurrentAddress" class="text-danger"></span>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="City" class="form-label">City</label>
                                <input list="cities" asp-for="City" class="form-control" placeholder="Type a city" />
                                <span asp-validation-for="City" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Education Details -->
                        <h5 class="text-info mt-4 mb-4"><i class="bi bi-book-fill"></i> Education Details</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="Qualification" type="text" class="form-label">Qualification</label>
                                <select asp-for="Qualification" class="form-control">
                                    <option value="">Select your qualification</option>
                                    <option value="BCA">BCA (Bachelor of Computer Applications)</option>
                                    <option value="MCA">MCA (Master of Computer Applications)</option>
                                    <option value="MBA">MBA (Master of Business Administration)</option>
                                    <option value="BBA">BBA (Bachelor of Business Administration)</option>
                                    <option value="BTech">B.Tech (Bachelor of Technology)</option>
                                    <option value="MTech">M.Tech (Master of Technology)</option>
                                    <option value="PhD">Ph.D.</option>
                                    <option value="Other">Other</option>
                                </select>
                                <span asp-validation-for="Qualification" class="text-danger"></span>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label asp-for="PreviousSchoolClg" class="form-label">Previous School/College</label>
                                <input asp-for="PreviousSchoolClg" class="form-control" placeholder="Enter previous institution" />
                                <span asp-validation-for="PreviousSchoolClg" class="text-danger"></span>
                            </div>
                            <div class="col-12 mb-3">
                                <label asp-for="Marks" class="form-label">Marks</label>
                                <input asp-for="Marks" class="form-control" placeholder="Enter marks obtained" />
                                <span asp-validation-for="Marks" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Course and Fees Details -->
                        <h5 class="text-info mt-4 mb-4"><i class="bi bi-coin"></i> Course and Fees Details</h5>
                        <div class="col-md-6 mb-3">
                            <label asp-for="AddmissionDate" class="form-label">Admission Date</label>
                            <input asp-for="AddmissionDate" id="AdmissionDate" type="date" class="form-control" placeholder="dd/mm/yyyy" />
                            <span asp-validation-for="AddmissionDate" class="text-danger"></span>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label asp-for="RegistrationFees" class="form-label">Registration Fees</label>
                            <input asp-for="RegistrationFees" id="registrationFees" class="form-control" placeholder="Enter registration fee" value="1000" readonly />
                            <span asp-validation-for="RegistrationFees" class="text-danger"></span>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label asp-for="PaymentMode" class="form-label">Payment Mode</label>
                            <select asp-for="PaymentMode" class="form-select" id="PaymentMode">
                                <option value="">Select Payment Mode</option>
                                <option value="Online">Online</option>
                                <option value="Cash">Cash</option>
                            </select>
                            <span asp-validation-for="PaymentMode" class="text-danger"></span>
                        </div>
                        <div class="col-12 mb-3" id="TransactionIdField" style="display: none;">
                            <label asp-for="TransactionId" class="form-label">Transaction ID</label>
                            <input asp-for="TransactionId" class="form-control" placeholder="Enter transaction ID" />
                            <span asp-validation-for="TransactionId" class="text-danger"></span>
                        </div>


                        <div class="row">
                            <div class="col-12 mb-3">
                                <label asp-for="Course" class="form-label">Course</label>
                                <select asp-for="Course"  id="languageDropdown" class="form-control" asp-items="ViewBag.Courses">
                                    <option value="">Select Course</option>
                                </select>
                                <span asp-validation-for="Course" class="text-danger"></span>
                            </div>

                            <!--Droup down list-->
                            <div class="col-12 mb-3">
                                <label asp-for="FrontEnd" class="form-label">FrontEnd</label>
                                <input asp-for="FrontEnd" class="form-control"/>
                                <span asp-validation-for="FrontEnd" class="text-danger"></span>
                            </div>

                            <div class="col-12 mb-3">
                                <label asp-for="BackEnd" class="form-label">BackEnd</label>
                                <input asp-for="BackEnd" class="form-control" />
                                <span asp-validation-for="BackEnd" class="text-danger"></span>
                            </div>

                            <div class="col-12 mb-3">
                                <label asp-for="DataBaseLanguage" class="form-label">DataBaseLanguage</label>
                                <input asp-for="DataBaseLanguage" class="form-control" />
                                <span asp-validation-for="DataBaseLanguage" class="text-danger"></span>
                            </div>

                           
                            <div class="col-md-6 mb-3">
                                <label asp-for="CourseFees" class="form-label">Course Fees</label>
                                <input asp-for="CourseFees" class="form-control" placeholder="Enter course fee" id="CourseFees" />
                                <span asp-validation-for="CourseFees" class="text-danger"></span>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label asp-for="Dicount" class="form-label">Discount (%)</label>
                                <input id="Discount" asp-for="Dicount" class="form-control" placeholder="Enter discount percentage" id="Discount" />
                                <span asp-validation-for="Dicount" class="text-danger"></span>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label asp-for="DicountedCourceFees" class="form-label">Discounted Course Fees</label>
                                <input asp-for="DicountedCourceFees" class="form-control" placeholder="Discounted course fee" id="DiscountedFees" readonly />
                                <span asp-validation-for ="DicountedCourceFees" class="text-danger"></span>
                            </div>
                        </div>

                        <!-- Installments -->
                        <h5 class="text-info mt-4 mb-4"><i class="bi bi-cash-stack"></i> Installments</h5>
                        <div class="row">
                            <p class="text-danger">NOTE: If you select the installment option, each installment will increase by 1000 rupees.</p>
                            <div class="col-md-6 mb-3">
                                <label asp-for="Installment" class="form-label">Installments</label>
                                <select asp-for="Installment" class="form-select" id="Installment">
                                    <option value="">Select Installments</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                </select>
                                <span asp-validation-for="Installment" class="text-danger"></span>
                            </div>
                            <div class="col-12" id="InstallmentFields"></div>
                        </div>

                        <!-- Admission Taken By -->
                        <div class="mb-3">
                            <label asp-for="AdmissionTakenBy" class="form-label">Admission Taken By</label>
                            <input asp-for="AdmissionTakenBy" class="form-control" placeholder="Enter your name" />
                            <span asp-validation-for="AdmissionTakenBy" class="text-danger"></span>
                        </div>

                          <div class="mb-3">
                            <label asp-for="Remark" class="form-label">Remark</label>
                            <input asp-for="Remark" class="form-control" placeholder="Enter your name" />
                            <span asp-validation-for="Remark" class="text-danger"></span>
                        </div>

                        <input type="hidden" asp-for="InquiryId" />

                        <!-- Submit Button -->
                        <div class="text-center mt-4">
                            <input type="submit" value="Save" class="btn btn-primary px-5 py-2" />
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center mt-3">
        <a asp-action="AddmissionTable" class="btn btn-secondary">Back to List</a>
    </div>
</div>


@section Scripts {
    <script>
        // Show/Hide Transaction ID field based on Payment Mode selection
        document.getElementById("PaymentMode").addEventListener("change", function () {
            const transactionField = document.getElementById("TransactionIdField");
            transactionField.style.display = this.value === "Online" ? "block" : "none";
        });

        // Automatically set the current date
        document.addEventListener('DOMContentLoaded', function () {
            const admissionDateInput = document.getElementById('AdmissionDate');
            const today = new Date().toISOString().split('T')[0]; // Format: yyyy-MM-dd
            admissionDateInput.value = today;
        });

        // Set default value for the input field in the Registration fees
        function calculateDiscountedFees() {
            var courseFees = (parseFloat(document.getElementById("CourseFees").value) || 0) - 1000;
            var discount = parseFloat(document.getElementById("Discount").value) || 0;
            var discountedFees = courseFees && discount >= 0 ? (courseFees - (courseFees * discount / 100)).toFixed(2) : '';
            document.getElementById("DiscountedFees").value = discountedFees;
        }

        // Event listeners for Course Fees and Discount fields
        ["CourseFees", "Discount"].forEach(id => document.getElementById(id).addEventListener("input", calculateDiscountedFees));

        document.getElementById("Installment").addEventListener("change", function () {
            const installmentFields = document.getElementById("InstallmentFields");
            const discountedFees = parseFloat(document.getElementById("DiscountedFees").value || 0); // Get discounted fees
            const count = parseInt(this.value, 10) || 0; // Get the number of installments

            installmentFields.innerHTML = ""; // Clear previous fields

            if (count > 0) {
                const installmentAmount = Math.floor((discountedFees / count) + 1000); // Base amount per installment
                const remainder = (discountedFees + (count * 1000)) % count; // Calculate remainder for distribution

                let table = `
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Installment</th>
                                <th>Date</th>
                                <th>Amount</th>
                            </tr>
                        </thead>
                        <tbody>`;

                if (count >= 1) {
                    let amount;
                    if(count===1){
                        amount = discountedFees;
                    }
                    else{
                     amount = installmentAmount + remainder;
                    }
                    table += `
                        <tr>
                            <td class="fw-bold">First Installment</td>
                            <td><input type="date" id="FirstDate" name="FirstDate" class="form-control" /></td>
                            <td><input type="number" name="FristInsta" class="form-control" value="${amount}" readonly /></td>
                        </tr>`;
                }

                if (count >= 2) {
                    const amount = installmentAmount;
                    table += `
                        <tr>
                            <td class="fw-bold">Second Installment</td>
                            <td><input type="date" id="SecondDate" name="SecondDate" class="form-control" readonly /></td>
                            <td><input type="number" name="SecondInsta" class="form-control" value="${amount}" readonly /></td>
                        </tr>`;
                }

                if (count >= 3) {
                    const amount = installmentAmount;
                    table += `
                        <tr>
                            <td class="fw-bold">Third Installment</td>
                            <td><input type="date" id="ThirdDate" name="ThirdDate" class="form-control" readonly /></td>
                            <td><input type="number" name="ThirdInsta" class="form-control" value="${amount}" readonly /></td>
                        </tr>`;
                }

                if (count >= 4) {
                    const amount = installmentAmount;
                    table += `
                        <tr>
                            <td class="fw-bold">Fourth Installment</td>
                            <td><input type="date" id="FourthDate" name="FourthDate" class="form-control" readonly /></td>
                            <td><input type="number" name="FourthInsta" class="form-control" value="${amount}" readonly /></td>
                        </tr>`;
                }

                if (count >= 5) {
                    const amount = installmentAmount;
                    table += `
                        <tr>
                            <td class="fw-bold">Fifth Installment</td>
                            <td><input type="date" id="FifthDate" name="FifthDate" class="form-control" readonly /></td>
                            <td><input type="number" name="FifthInsta" class="form-control" value="${amount}" readonly /></td>
                        </tr>`;
                }

                if (count === 6) {
                    const amount = installmentAmount;
                    table += `
                        <tr>
                            <td class="fw-bold">Sixth Installment</td>
                            <td><input type="date" id="SixthDate" name="SixDate" class="form-control" readonly /></td>
                            <td><input type="number" name="SixInsta" class="form-control" value="${amount}" readonly /></td>
                        </tr>`;
                }

                table += `
                        </tbody>
                    </table>`;
                installmentFields.innerHTML += table;



                // Add event listener for first date field
                document.getElementById("FirstDate").addEventListener("change", function () {
                    const firstDateValue = this.value;
                    if (firstDateValue) {
                        let currentDate = new Date(firstDateValue);

                        if (count >= 2) {
                            currentDate.setMonth(currentDate.getMonth() + 1);
                            const secondDateField = document.getElementById("SecondDate");
                            if (secondDateField) {
                                secondDateField.value = currentDate.toISOString().split("T")[0];
                            }
                        }

                        if (count >= 3) {
                            currentDate.setMonth(currentDate.getMonth() + 1);
                            const thirdDateField = document.getElementById("ThirdDate");
                            if (thirdDateField) {
                                thirdDateField.value = currentDate.toISOString().split("T")[0];
                            }
                        }

                        if (count >= 4) {
                            currentDate.setMonth(currentDate.getMonth() + 1);
                            const fourthDateField = document.getElementById("FourthDate");
                            if (fourthDateField) {
                                fourthDateField.value = currentDate.toISOString().split("T")[0];
                            }
                        }

                        if (count >= 5) {
                            currentDate.setMonth(currentDate.getMonth() + 1);
                            const fifthDateField = document.getElementById("FifthDate");
                            if (fifthDateField) {
                                fifthDateField.value = currentDate.toISOString().split("T")[0];
                            }
                        }

                        if (count === 6) {
                            currentDate.setMonth(currentDate.getMonth() + 1);
                            const sixthDateField = document.getElementById("SixthDate");
                            if (sixthDateField) {
                                sixthDateField.value = currentDate.toISOString().split("T")[0];
                            }
                        }
                    }
                });
            } else {
                installmentFields.innerHTML = "<p>No installments to display.</p>";
            }
        });
        //Course droupdown

       

    </script>


    
}
